<!--
  Copyright 2026 John Kost
  Licensed under the Apache License, Version 2.0
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReMixr IDE</title>
  <link rel="stylesheet" href="popup.css">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">
  <!-- CodeMirror -->
  <link rel="stylesheet" href="lib/codemirror/codemirror.min.css">
  <link rel="stylesheet" href="lib/codemirror/theme/dracula.min.css">
</head>

<body>

  <div class="container">
    <!-- Header -->
    <header>
      <h1>ReMixr IDE</h1>
      <p class="tagline">Meta-Extension Environment</p>
    </header>

    <!-- Navigation -->
    <nav class="tabs">
      <button class="tab-btn active" data-tab="projects">Projects</button>
      <button class="tab-btn" data-tab="templates">Templates</button>
      <button class="tab-btn" data-tab="builder">Builder</button>
      <button class="tab-btn" data-tab="analyzer">Inspector</button>
      <button class="tab-btn" data-tab="tools">Tools</button>
    </nav>

    <!-- CONTENT AREAS -->

    <!-- Projects Tab -->
    <div id="projects-tab" class="tab-content active">
      <div class="section">
        <h2>Your Projects</h2>
        <button id="new-project-btn" class="btn btn-primary" style="width: 100%; margin-bottom: 15px;">
          + New Project
        </button>
        <div id="projects-list" class="projects-list">
          <!-- Populated by JS -->
          <div class="empty-state">No projects found. Start building!</div>
        </div>
      </div>
    </div>

    <!-- Templates Tab -->
    <div id="templates-tab" class="tab-content">
      <div class="section">
        <h2>Templates</h2>
        <div class="templates-grid">
          <div class="template-card" data-template="starter">
            <div class="template-icon">ğŸš€</div>
            <h3>Starter</h3>
            <p>Empty Boilerplate</p>
          </div>
          <div class="template-card" data-template="content-modifier">
            <div class="template-icon">ğŸ¨</div>
            <h3>Modifier</h3>
            <p>Inject CSS/JS</p>
          </div>
          <div class="template-card" data-template="data-extractor">
            <div class="template-icon">ğŸ“Š</div>
            <h3>Scraper</h3>
            <p>Extract Data</p>
          </div>
          <div class="template-card" data-template="productivity">
            <div class="template-icon">â±ï¸</div>
            <h3>Timer</h3>
            <p>Productivity</p>
          </div>
          <div class="template-card" data-template="popup-tool">
            <div class="template-icon">ğŸ”§</div>
            <h3>Utility</h3>
            <p>Popup Tool</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Builder Tab -->
    <div id="builder-tab" class="tab-content">
      <div class="section">
        <div class="builder-controls-header">
          <div class="builder-header">
            <input type="text" id="project-name" placeholder="Extension Name" class="project-name-input">
            <div class="builder-actions">
              <button id="save-project-btn" class="btn btn-secondary btn-small">Save</button>
              <button id="test-extension-btn" class="btn btn-primary btn-small">Load</button>
            </div>
          </div>

          <div class="ai-section">
            <textarea id="ai-prompt"
              placeholder="Describe functionality... e.g. 'Highlight all external links in red'"></textarea>
            <button id="generate-btn" class="btn btn-primary btn-small">âœ¨ AI Generate</button>
          </div>

          <div class="files-section">
            <h3>Files</h3>
            <div class="file-tree" id="file-tree">
              <div class="file-item active" data-file="manifest.json">manifest.json</div>
              <div class="file-item" data-file="popup.html">popup.html</div>
              <div class="file-item" data-file="popup.js">popup.js</div>
              <div class="file-item" data-file="content.js">content.js</div>
              <div class="file-item" data-file="background.js">background.js</div>
              <div class="file-item" data-file="styles.css">styles.css</div>
            </div>
          </div>
        </div>

        <div class="editor-section">
          <div class="editor-header">
            <span id="current-file">manifest.json</span>
          </div>
          <textarea id="code-editor"></textarea>
        </div>

        <div class="builder-footer">
          <button id="export-extension-btn" class="btn btn-secondary btn-small" style="flex:1;">Download ZIP</button>
          <button id="preview-btn" class="btn btn-secondary btn-small" style="flex:1;">Preview UI</button>
        </div>

        <!-- Preview Modal/Divider (Hidden by default) -->
        <div id="preview-container"
          style="display: none; margin-top: 15px; border-top: 1px solid var(--border-color); padding-top: 15px;">
          <h3>Preview</h3>
          <div class="preview-frame-wrapper" style="background:#fff; padding:10px; border-radius:4px;">
            <iframe id="preview-frame" style="width:100%; height:300px; border:1px solid #ddd;"></iframe>
          </div>
          <button id="close-preview" class="btn btn-secondary btn-small" style="width:100%; margin-top:5px;">Close
            Preview</button>
        </div>

      </div>
    </div>

    <!-- Analyzer/Inspector Tab -->
    <div id="analyzer-tab" class="tab-content">
      <div class="section">
        <div class="analyzer-controls">
          <div class="analyzer-card">
            <div class="card-header">
              <h3>Diagnostic Suite</h3>
              <label class="switch" title="Real-time element inspection overlay">
                <input type="checkbox" id="inspector-toggle">
                <span class="slider"></span>
              </label>
            </div>
            <p style="font-size: 11px; color: var(--text-dim); margin-top: 6px;">
              Toggle the Inspector to highlight elements directly on the page.
            </p>
          </div>

          <div class="suite-header">
            <h2>Scan Suite</h2>
            <div class="suite-tag">Internal Engines</div>
          </div>
          <div class="tools-grid">
            <button id="scan-visualize" class="tool-btn" title="Generate a DOM tree graph">
              <span class="icon">ğŸ•¸ï¸</span> <span class="tool-btn-label">Graph</span>
            </button>
            <button id="scan-sequence" class="tool-btn" title="Generate a UML Sequence diagram of page logic">
              <span class="icon">ğŸ§¬</span> <span class="tool-btn-label">Sequence</span>
            </button>
            <button id="scan-structure" class="tool-btn" title="Analyze element counts and nesting">
              <span class="icon">ğŸ—ï¸</span> <span class="tool-btn-label">Struct</span>
            </button>
            <button id="scan-palette" class="tool-btn" title="Extract page color palette">
              <span class="icon">ğŸ¨</span> <span class="tool-btn-label">Palette</span>
            </button>
            <button id="scan-assets" class="tool-btn" title="Audit resources">
              <span class="icon">ğŸ“¦</span> <span class="tool-btn-label">Assets</span>
            </button>
            <button id="scan-fonts" class="tool-btn" title="Identify fonts">
              <span class="icon">ğŸ”¤</span> <span class="tool-btn-label">Fonts</span>
            </button>
            <button id="scan-storage" class="tool-btn" title="Audit LocalStorage & Cookies">
              <span class="icon">ğŸ’¾</span> <span class="tool-btn-label">Storage</span>
            </button>
            <button id="scan-workers" class="tool-btn" title="List service workers">
              <span class="icon">âš™ï¸</span> <span class="tool-btn-label">Worker</span>
            </button>
            <button id="scan-a11y" class="tool-btn" title="Accessibility health check (Alt text, Contrast, Labels)">
              <span class="icon">â™¿</span> A11y
            </button>
            <button id="scan-seo" class="tool-btn" title="SEO health check (Meta tags, Headings, Links)">
              <span class="icon">ğŸ“ˆ</span> SEO
            </button>
            <button id="scan-code" class="tool-btn" title="Code Visualizer: Analyze scripts and code distribution">
              <span class="icon">ğŸ“œ</span> Code
            </button>
            <button id="scan-net" class="tool-btn" title="Network Visualizer: Analyze XHR/Fetch and API traffic">
              <span class="icon">ğŸŒ</span> Network
            </button>
            <button id="scan-perf" class="tool-btn" title="Measure page load times">
              <span class="icon">âš¡</span> <span class="tool-btn-label">Perf</span>
            </button>
            <button id="scan-stack" class="tool-btn" title="Identify libraries">
              <span class="icon">ğŸ§¬</span> <span class="tool-btn-label">Stack</span>
            </button>
          </div>
        </div>

        <div id="analysis-results" class="results-area" style="display: none;">
          <div class="results-header">
            <strong id="result-title">Analysis Results</strong>
            <span id="clear-results" style="cursor:pointer; color: var(--accent-color); font-size: 11px;">Clear</span>
          </div>
          <div id="result-content"></div>
          <div id="d3-container" style="display: none;"></div>
        </div>
      </div>
    </div>


    <!-- Tools Tab -->
    <div id="tools-tab" class="tab-content">
      <div class="section">
        <div class="suite-header">
          <h2>Operation Suite</h2>
          <div class="suite-tag">Quick Actions</div>
        </div>
        <div class="tools-grid">
          <button id="tool-edit" class="tool-btn" title="Toggle universal edit mode">
            <span class="icon">âœï¸</span> <span class="tool-btn-label">Edit</span>
          </button>
          <button id="tool-zap" class="tool-btn" title="Remove element from DOM">
            <span class="icon">âš¡</span> <span class="tool-btn-label">Zap</span>
          </button>
          <button id="tool-wireframe" class="tool-btn" title="Toggle wireframe mode">
            <span class="icon">ğŸ–¼ï¸</span> <span class="tool-btn-label">Wire</span>
          </button>
          <button id="tool-images" class="tool-btn" title="Toggle image visibility">
            <span class="icon">ğŸ‘ï¸</span> <span class="tool-btn-label">Images</span>
          </button>
          <button id="tool-unmask" class="tool-btn" title="Show password fields">
            <span class="icon">ğŸ”‘</span> <span class="tool-btn-label">Unmask</span>
          </button>
          <button id="tool-enable" class="tool-btn" title="Enable disabled inputs">
            <span class="icon">ğŸ”“</span> <span class="tool-btn-label">Inputs</span>
          </button>
          <button id="tool-kill-sticky" class="tool-btn" title="Remove sticky elements">
            <span class="icon">ğŸ©¹</span> <span class="tool-btn-label">Stickies</span>
          </button>
          <button id="tool-pii" class="tool-btn" title="Scan for emails">
            <span class="icon">ğŸ“§</span> <span class="tool-btn-label">Emails</span>
          </button>
          <button id="tool-export-links" class="tool-btn" title="Extract links">
            <span class="icon">ğŸ”—</span> <span class="tool-btn-label">Links</span>
          </button>
          <button id="tool-export-colors" class="tool-btn" title="Extract colors">
            <span class="icon">ğŸ¨</span> <span class="tool-btn-label">Colors</span>
          </button>
          <button id="tool-screenshot" class="tool-btn" title="Take screenshot">
            <span class="icon">ğŸ“¸</span> <span class="tool-btn-label">Shot</span>
          </button>
          <button id="tool-console" class="tool-btn" title="Inject console">
            <span class="icon">ğŸ’»</span> <span class="tool-btn-label">Console</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Status Bar & Toast moved inside container -->
    <div id="status" class="status"></div>

    <footer class="status-bar">
      <div id="status-message">ReMixr IDE // Build 1.0.4 Ready</div>
      <div class="status-indicators">
        <span class="indicator">WASM</span>
        <span class="indicator">V3</span>
        <span class="indicator-active">ACTIVE</span>
      </div>
    </footer>
  </div>



  <!-- Scripts -->
  <script src="lib/d3.v7.min.js"></script>
  <script src="lib/jszip.min.js"></script>
  <!-- CodeMirror -->
  <script src="lib/codemirror/codemirror.min.js"></script>
  <script src="lib/codemirror/mode/javascript.min.js"></script>
  <script src="lib/codemirror/mode/css.min.js"></script>
  <script src="lib/codemirror/mode/xml.min.js"></script>
  <script src="lib/codemirror/mode/htmlmixed.min.js"></script>

  <script src="popup.js"></script>
  <script src="export.js"></script>
</body>

</html>