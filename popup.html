<!--
  Copyright 2026 John Kost
  Licensed under the Apache License, Version 2.0
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReMixr IDE</title>
  <link rel="stylesheet" href="popup.css">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">
  <!-- CodeMirror -->
  <link rel="stylesheet" href="lib/codemirror/codemirror.min.css">
  <link rel="stylesheet" href="lib/codemirror/theme/dracula.min.css">
</head>

<body>

  <div class="container">
    <!-- Header -->
    <header>
      <h1>ReMixr IDE</h1>
      <p class="tagline">Meta-Extension Builder</p>
    </header>

    <!-- Navigation -->
    <nav class="tabs">
      <button class="tab-btn active" data-tab="projects">Projects</button>
      <button class="tab-btn" data-tab="templates">Templates</button>
      <button class="tab-btn" data-tab="builder">Builder</button>
      <button class="tab-btn" data-tab="analyzer">Inspector</button>
      <button class="tab-btn" data-tab="tools">Tools</button>
    </nav>

    <!-- CONTENT AREAS -->

    <!-- Projects Tab -->
    <div id="projects-tab" class="tab-content active">
      <div class="section">
        <h2>Your Projects</h2>
        <button id="new-project-btn" class="btn btn-primary" style="width: 100%; margin-bottom: 15px;">
          + New Project
        </button>
        <div id="projects-list" class="projects-list">
          <!-- Populated by JS -->
          <div class="empty-state">No projects found. Start building!</div>
        </div>
      </div>
    </div>

    <!-- Templates Tab -->
    <div id="templates-tab" class="tab-content">
      <div class="section">
        <h2>Quick Templates</h2>
        <div class="templates-grid">
          <div class="template-card" data-template="starter">
            <div class="template-icon">üöÄ</div>
            <h3>Starter</h3>
            <p>Empty Boilerplate</p>
          </div>
          <div class="template-card" data-template="content-modifier">
            <div class="template-icon">üé®</div>
            <h3>Modifier</h3>
            <p>Inject CSS/JS</p>
          </div>
          <div class="template-card" data-template="data-extractor">
            <div class="template-icon">üìä</div>
            <h3>Scraper</h3>
            <p>Extract Data</p>
          </div>
          <div class="template-card" data-template="productivity">
            <div class="template-icon">‚è±Ô∏è</div>
            <h3>Timer</h3>
            <p>Productivity</p>
          </div>
          <div class="template-card" data-template="popup-tool">
            <div class="template-icon">üîß</div>
            <h3>Utility</h3>
            <p>Popup Tool</p>
          </div>
        </div>

        <div style="height: 32px;"></div>

        <h2>Extension Wizard</h2>
        
        <!-- Extension Wizard -->
        <div class="wizard-container">
          <div class="wizard-header">
            <div class="wizard-icon">‚ú®</div>
            <div>
              <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Scaffold Chrome Extension</h3>
              <p style="margin: 4px 0 0 0; font-size: 13px; color: var(--text-secondary);">Configure features and generate your extension structure</p>
            </div>
          </div>

          <div class="wizard-section">
            <label class="wizard-label">Extension Name</label>
            <input type="text" id="wizard-name" class="wizard-input" placeholder="My Awesome Extension">
          </div>

          <div class="wizard-section">
            <label class="wizard-label">Description</label>
            <input type="text" id="wizard-description" class="wizard-input" placeholder="Enhance your browsing experience">
          </div>

          <div class="wizard-section">
            <label class="wizard-label">Extension Type</label>
            <div class="wizard-radio-group">
              <label class="wizard-radio">
                <input type="radio" name="ext-type" value="content-script" checked>
                <span>Content Script (Modify Pages)</span>
              </label>
              <label class="wizard-radio">
                <input type="radio" name="ext-type" value="popup">
                <span>Browser Action (Popup)</span>
              </label>
              <label class="wizard-radio">
                <input type="radio" name="ext-type" value="side-panel">
                <span>Side Panel</span>
              </label>
              <label class="wizard-radio">
                <input type="radio" name="ext-type" value="page-action">
                <span>Page Action (Contextual)</span>
              </label>
            </div>
          </div>

          <div class="wizard-section">
            <label class="wizard-label">Features</label>
            <div class="wizard-checkbox-grid">
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-background">
                <span>Background Service Worker</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-storage">
                <span>Local Storage</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-tabs">
                <span>Tab Management</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-context-menu">
                <span>Context Menu Items</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-notifications">
                <span>Notifications</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-bookmarks">
                <span>Bookmarks Access</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-history">
                <span>History Access</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-downloads">
                <span>Download Management</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-cookies">
                <span>Cookie Access</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="feat-web-request">
                <span>Network Interception</span>
              </label>
            </div>
          </div>

          <div class="wizard-section">
            <label class="wizard-label">Host Permissions</label>
            <div class="wizard-radio-group">
              <label class="wizard-radio">
                <input type="radio" name="host-perms" value="active-tab" checked>
                <span>Active Tab Only</span>
              </label>
              <label class="wizard-radio">
                <input type="radio" name="host-perms" value="all-urls">
                <span>All Websites</span>
              </label>
              <label class="wizard-radio">
                <input type="radio" name="host-perms" value="custom">
                <span>Custom Domains</span>
              </label>
            </div>
            <input type="text" id="wizard-custom-hosts" class="wizard-input" placeholder="https://example.com/*" style="display: none; margin-top: 12px;">
          </div>

          <div class="wizard-section">
            <label class="wizard-label">UI Framework (Optional)</label>
            <select id="wizard-framework" class="wizard-select">
              <option value="vanilla">Vanilla JavaScript</option>
              <option value="react">React</option>
              <option value="vue">Vue</option>
              <option value="svelte">Svelte</option>
            </select>
          </div>

          <div class="wizard-section">
            <label class="wizard-label">Behaviors</label>
            <div class="wizard-checkbox-grid">
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-match-site">
                <span>Match Parent Site Style</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-auto-open">
                <span>Auto-Open Side Panel</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-persist-state">
                <span>Persist State</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-keyboard">
                <span>Keyboard Shortcuts</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-badge">
                <span>Badge Notifications</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-auto-run">
                <span>Auto-Run on Load</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-sync">
                <span>Sync Across Devices</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-theme">
                <span>Theme Support</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-analytics">
                <span>Usage Analytics</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-hotreload">
                <span>Hot Reload Dev Mode</span>
              </label>
              <label class="wizard-checkbox">
                <input type="checkbox" id="behavior-error-tracking">
                <span>Error Tracking</span>
              </label>
            </div>
          </div>

          <button id="generate-extension-btn" class="btn btn-primary" style="width: 100%; margin-top: 8px;">
            Generate Extension
          </button>
        </div>
      </div>
    </div>

    <!-- Builder Tab -->
    <div id="builder-tab" class="tab-content">
      <div class="section">
        <div class="builder-controls-header">
          <div class="builder-header">
            <input type="text" id="project-name" placeholder="Extension Name" class="project-name-input">
            <div class="builder-actions">
              <button id="save-project-btn" class="btn btn-secondary btn-small">Save</button>
              <button id="test-extension-btn" class="btn btn-primary btn-small">Load</button>
            </div>
          </div>

          <div class="ai-section">
            <textarea id="ai-prompt"
              placeholder="Describe functionality... e.g. 'Highlight all external links in red'"></textarea>
            <button id="generate-btn" class="btn btn-primary btn-small">‚ú® AI Generate</button>
          </div>

          <div class="files-section">
            <h3>Files</h3>
            <div class="file-tree" id="file-tree">
              <div class="file-item active" data-file="manifest.json">manifest.json</div>
              <div class="file-item" data-file="popup.html">popup.html</div>
              <div class="file-item" data-file="popup.js">popup.js</div>
              <div class="file-item" data-file="content.js">content.js</div>
              <div class="file-item" data-file="background.js">background.js</div>
              <div class="file-item" data-file="styles.css">styles.css</div>
            </div>
          </div>
        </div>

        <div class="editor-section">
          <div class="editor-header">
            <span id="current-file">manifest.json</span>
          </div>
          <textarea id="code-editor"></textarea>
        </div>

        <div class="builder-footer">
          <button id="export-extension-btn" class="btn btn-secondary btn-small" style="flex:1;">Download ZIP</button>
          <button id="preview-btn" class="btn btn-secondary btn-small" style="flex:1;">Preview UI</button>
        </div>

        <!-- Preview Modal/Divider (Hidden by default) -->
        <div id="preview-container"
          style="display: none; margin-top: 15px; border-top: 1px solid var(--border-color); padding-top: 15px;">
          <h3>Preview</h3>
          <div class="preview-frame-wrapper" style="background:#fff; padding:10px; border-radius:4px;">
            <iframe id="preview-frame" style="width:100%; height:300px; border:1px solid #ddd;"></iframe>
          </div>
          <button id="close-preview" class="btn btn-secondary btn-small" style="width:100%; margin-top:5px;">Close
            Preview</button>
        </div>

      </div>
    </div>

    <!-- Analyzer/Inspector Tab -->
    <div id="analyzer-tab" class="tab-content">
      <div class="section">
        <div class="analyzer-controls">
          <div class="analyzer-card">
            <div class="card-header">
              <h3>Diagnostic Suite</h3>
              <label class="switch" title="Real-time element inspection overlay">
                <input type="checkbox" id="inspector-toggle">
                <span class="slider"></span>
              </label>
            </div>
            <p style="font-size: 11px; color: var(--text-dim); margin-top: 6px;">
              Toggle the Inspector to highlight elements directly on the page.
            </p>
          </div>

          <div class="suite-header">
            <h2>Scan Suite</h2>
            <div class="suite-tag">Internal Engines</div>
          </div>
          <div class="tools-grid">
            <button id="scan-visualize" class="tool-btn" title="Generate a DOM tree graph">
              <span class="icon">üï∏Ô∏è</span> <span class="tool-btn-label">Graph</span>
            </button>
            <button id="scan-sequence" class="tool-btn" title="Generate a UML Sequence diagram of page logic">
              <span class="icon">üß¨</span> <span class="tool-btn-label">Sequence</span>
            </button>
            <button id="scan-structure" class="tool-btn" title="Analyze element counts and nesting">
              <span class="icon">üèóÔ∏è</span> <span class="tool-btn-label">Struct</span>
            </button>
            <button id="scan-palette" class="tool-btn" title="Extract page color palette">
              <span class="icon">üé®</span> <span class="tool-btn-label">Palette</span>
            </button>
            <button id="scan-assets" class="tool-btn" title="Audit resources">
              <span class="icon">üì¶</span> <span class="tool-btn-label">Assets</span>
            </button>
            <button id="scan-fonts" class="tool-btn" title="Identify fonts">
              <span class="icon">üî§</span> <span class="tool-btn-label">Fonts</span>
            </button>
            <button id="scan-storage" class="tool-btn" title="Audit LocalStorage & Cookies">
              <span class="icon">üíæ</span> <span class="tool-btn-label">Storage</span>
            </button>
            <button id="scan-workers" class="tool-btn" title="List service workers">
              <span class="icon">‚öôÔ∏è</span> <span class="tool-btn-label">Worker</span>
            </button>
            <button id="scan-a11y" class="tool-btn" title="Accessibility health check (Alt text, Contrast, Labels)">
              <span class="icon">‚ôø</span> A11y
            </button>
            <button id="scan-seo" class="tool-btn" title="SEO health check (Meta tags, Headings, Links)">
              <span class="icon">üìà</span> SEO
            </button>
            <button id="scan-code" class="tool-btn" title="Code Visualizer: Analyze scripts and code distribution">
              <span class="icon">üìú</span> Code
            </button>
            <button id="scan-net" class="tool-btn" title="Network Visualizer: Analyze XHR/Fetch and API traffic">
              <span class="icon">üåê</span> Network
            </button>
            <button id="scan-perf" class="tool-btn" title="Measure page load times">
              <span class="icon">‚ö°</span> <span class="tool-btn-label">Perf</span>
            </button>
            <button id="scan-stack" class="tool-btn" title="Identify libraries">
              <span class="icon">üß¨</span> <span class="tool-btn-label">Stack</span>
            </button>
            <button id="scan-psyche" class="tool-btn" title="Psychological Pattern Analysis - Dark patterns, persuasion, manipulation">
              <span class="icon">üß†</span> <span class="tool-btn-label">Psyche</span>
            </button>
            <button id="scan-archetype" class="tool-btn" title="Brand Archetype & Symbolic Analysis">
              <span class="icon">üé≠</span> <span class="tool-btn-label">Archetype</span>
            </button>
            <button id="scan-soul" class="tool-btn" title="Soul Analysis - Authenticity, intention, coherence">
              <span class="icon">‚ú®</span> <span class="tool-btn-label">Soul</span>
            </button>
            <button id="scan-shadow" class="tool-btn" title="Shadow Analysis - Hidden manipulations, deceptive patterns">
              <span class="icon">üåë</span> <span class="tool-btn-label">Shadow</span>
            </button>
            <button id="scan-rhetoric" class="tool-btn" title="Rhetorical Analysis - Linguistic patterns, persuasion techniques">
              <span class="icon">üìú</span> <span class="tool-btn-label">Rhetoric</span>
            </button>
            <button id="scan-emotion" class="tool-btn" title="Emotional Design Analysis - Psychology of colors, typography, space">
              <span class="icon">üí≠</span> <span class="tool-btn-label">Emotion</span>
            </button>
          </div>
        </div>

        <div id="analysis-results" class="results-area" style="display: none;">
          <div class="results-header">
            <strong id="result-title">Analysis Results</strong>
            <div class="results-header-actions">
              <button id="fullscreen-toggle" class="fullscreen-btn" title="Toggle Fullscreen">‚õ∂</button>
              <span id="clear-results">Clear</span>
            </div>
          </div>
          <div id="result-content"></div>
          <div id="d3-container" style="display: none;"></div>
        </div>
      </div>
    </div>


    <!-- Tools Tab -->
    <div id="tools-tab" class="tab-content">
      <div class="section">
        <div class="suite-header">
          <h2>Operation Suite</h2>
          <div class="suite-tag">Quick Actions</div>
        </div>
        <div class="tools-grid">
          <button id="tool-edit" class="tool-btn" title="Toggle universal edit mode">
            <span class="icon">‚úèÔ∏è</span> <span class="tool-btn-label">Edit</span>
          </button>
          <button id="tool-zap" class="tool-btn" title="Remove element from DOM">
            <span class="icon">‚ö°</span> <span class="tool-btn-label">Zap</span>
          </button>
          <button id="tool-wireframe" class="tool-btn" title="Toggle wireframe mode">
            <span class="icon">üñºÔ∏è</span> <span class="tool-btn-label">Wire</span>
          </button>
          <button id="tool-images" class="tool-btn" title="Toggle image visibility">
            <span class="icon">üëÅÔ∏è</span> <span class="tool-btn-label">Images</span>
          </button>
          <button id="tool-unmask" class="tool-btn" title="Show password fields">
            <span class="icon">üîë</span> <span class="tool-btn-label">Unmask</span>
          </button>
          <button id="tool-enable" class="tool-btn" title="Enable disabled inputs">
            <span class="icon">üîì</span> <span class="tool-btn-label">Inputs</span>
          </button>
          <button id="tool-kill-sticky" class="tool-btn" title="Remove sticky elements">
            <span class="icon">ü©π</span> <span class="tool-btn-label">Stickies</span>
          </button>
          <button id="tool-pii" class="tool-btn" title="Scan for emails">
            <span class="icon">üìß</span> <span class="tool-btn-label">Emails</span>
          </button>
          <button id="tool-export-links" class="tool-btn" title="Extract links">
            <span class="icon">üîó</span> <span class="tool-btn-label">Links</span>
          </button>
          <button id="tool-export-colors" class="tool-btn" title="Extract colors">
            <span class="icon">üé®</span> <span class="tool-btn-label">Colors</span>
          </button>
          <button id="tool-screenshot" class="tool-btn" title="Take screenshot">
            <span class="icon">üì∏</span> <span class="tool-btn-label">Shot</span>
          </button>
          <button id="tool-console" class="tool-btn" title="Inject console">
            <span class="icon">üíª</span> <span class="tool-btn-label">Console</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Status Bar & Toast moved inside container -->
    <div id="status" class="status"></div>

    <footer class="status-bar">
      <div id="status-message">ReMixr IDE // Build 1.0.4 Ready</div>
      <div class="status-indicators">
        <span class="indicator">WASM</span>
        <span class="indicator">V3</span>
        <span class="indicator-active">ACTIVE</span>
      </div>
    </footer>
  </div>



  <!-- Scripts -->
  <script src="lib/d3.v7.min.js"></script>
  <script src="lib/jszip.min.js"></script>
  <!-- CodeMirror -->
  <script src="lib/codemirror/codemirror.min.js"></script>
  <script src="lib/codemirror/mode/javascript.min.js"></script>
  <script src="lib/codemirror/mode/css.min.js"></script>
  <script src="lib/codemirror/mode/xml.min.js"></script>
  <script src="lib/codemirror/mode/htmlmixed.min.js"></script>

  <script src="popup.js"></script>
  <script src="export.js"></script>
</body>

</html>